---
given:
  pattern:
    - mov:
      - "$any"
      - "@deref":
        - main_reg: "$any-ptr"
          register_multiplier: "@any-idx"
          constant_multiplier: "@any-size"
      address-capture: deref-address
where:
  - @func.anyarg -> ptr
  - analysis-end := deref-address
then:
  - upper_unbounded(ptr + idx*size)
report: "Uncontrolled user input could lead to SMM memory corruption"
